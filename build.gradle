buildscript {
    repositories {
        mavenCentral()
    }
    dependencies {
        classpath('io.sealights.on-premise.agents.plugin:sealights-gradle-plugin:3.1.735')
    }
}

plugins {
    id 'java'
}

group 'dev.futa.sealights'
version '1.0-SNAPSHOT'

repositories {
    mavenCentral()
}

ext {
    set('runnerEnabled', false)
}

dependencies {// https://mvnrepository.com/artifact/org.springframework/spring-web
    implementation 'org.springframework:spring-web:5.3.24'
    testImplementation 'org.junit.jupiter:junit-jupiter-api:5.8.1'
    testRuntimeOnly 'org.junit.jupiter:junit-jupiter-engine:5.8.1'
}

test {
    useJUnitPlatform()
}

if (ext['runnerEnabled']) {
    allprojects.each { p ->
        def included = []
        def excluded = []

        if (!included.isEmpty()) {
            println "[SeaLights Integration] Including only projects: ${included}"
        }

        if (!excluded.isEmpty()) {
            println "[SeaLights Integration] Excluding projects: ${excluded}"
        }

        if (!excluded.contains(p.name) &&
                (included.isEmpty() || included.contains(p.name))) {
            println "[SeaLights Integration] SeaLights applied to project: '${p.name}'"

            p.afterEvaluate {

                p.apply plugin: io.sealights.onpremise.agents.plugin.SealightsPlugin
                p.sealights {

                    token = "eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL0RFVi1mdHYuYXV0aC5zZWFsaWdodHMuaW8vIiwiand0aWQiOiJERVYtZnR2LGktMGMxNjU4YjA0ZTljMDMwMzMsQVBJR1ctOTYzN2FjOGUtMzAyYy00YTk1LTkyZjItZGExNTFiNDljNDI0LDE2NzA0MjE2MzI1NDAiLCJzdWJqZWN0IjoiU2VhTGlnaHRzQGFnZW50IiwiYXVkaWVuY2UiOlsiYWdlbnRzIl0sIngtc2wtcm9sZSI6ImFnZW50IiwieC1zbC1zZXJ2ZXIiOiJodHRwczovL2Rldi1mdHYtZ3cuZGV2LnNlYWxpZ2h0cy5jby9hcGkiLCJzbF9pbXBlcl9zdWJqZWN0IjoiIiwiaWF0IjoxNjcwNDIxNjMyfQ.IyAO7_zibgusLv_pPwTwlBICvRwh7EbC7Ee-Zqmx6azkjaRYDb8olKjiWM_HeYFGnIIczAuWIurFUm-h9noPOzLp-0h-r6fu3Yt4utvF9b1NhQNtL9aLlJ4-h7kDZA7K5AN39Agx6DB_be9XLcLHnwANskq16xn-H6xOOqq-VFqrN98hUl_sRiHf0CKm6RbsumyF1byqZIizENT7unGfJc6tP0poNRgpJkue0UJklgT6HRT8bPi_7rJJgUAu6Vb0LhkCManH_CsllFMxSMBFMJWM-Zxvs5pKHmK1JcIuy08i0r0cJR1axLDtFXcx8Fn_u1dtpLMk-BZCUCOKxh-YXT651AjvCsHwX2JCqxlcD7aLaQIMC3mmq6Qie7YezILQ6_GYDu-oREVgQsN2eob2k0oiFloLn4AmJllq66GasP8Oq20MuHScWvop95McYiictsdHohkkb_z97UIj70LF49qNTJxy5ZGeY90vbZ34mFBfF7cTAXY47q5ReqpyokYx-DABpjFYgS-1i6x_e-4_3Zreni1-SOmueHhhFS_S9hC-gLXvJuiDwIDPaxR16eF_I-S4w0l0071ddqt_-8HgoQcfV85zOzpgHz7IjCfhDIUDB3eI_uwW523hV-4eCoM8ElRa7lCfhQlL2iwEn-623dVjEZI1cD2sfX3B1_efpQ4"
                    packagesIncluded = "dev.futa.sealights*"
                    proxy = ""
                    recursive = true
                    includeResources = true
                    testStage = "Other Phase Tests"
                    labId = "integ_puppet_038a_gfftvlab02"
                    runFunctionalTests = true
                    runTestOnly = true
                    logEnabled = false
                    logPluginMinimal = false
                    logToConsole = true
                    logLevel = "info"
                    createBuildSessionId = false
                    sealightsJvmParams = [:]

                }
            }
        }
    }
}